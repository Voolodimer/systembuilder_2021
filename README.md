# systembuilder_2021
version: 0.9
CI wrapper over github actions. Lanit-Tercom student projects 2021.
## Описание проекта CI/CD
CI/CD — это комбинация непрерывной интеграции (Continuous Itegration) и непрерывной доставки (Continuous Delivery).
При данном подходе происходит постоянное слияние рабочих копий в общую основную ветвь разработки и выполнение частых автоматизированных сборок
с целью выявления возможных дефектов и решения проблем интеграции.
## Процесс установки
```
git clone https://github.com/antonkurenkov/systembuilder_2021
pip install -r requirements.txt
```
## Документация
Валидный проект должен содержать в себе файлы manifest.yml и Dockerfile, необходимые для осуществления сборки. Сборка осуществляется после отправки коммита в ветку репозитория, указанную в файле on-commit.yml.
При коммите в наш репозиторий срабатывает github action который:
- проверяет наличие в коммите строки "chore: upload status", в случае отсутствия строки мы начинаем процесс сборки на виртуальной машине gitHub 
- запускает скрип-сборщик builder.py который проверяющий директорию collection на наличие поектов для сборки
- Внутри builder.py запускается скрипт manifest.py при помощи которого мы получаем содержимое Docker файла и файла manifest.yml
builder.py запускает сборку для каждого из элементов коллекции и обновляет внутренний словарь status map
Результатом работы builder.py и сборки всех проектов в коллекции, будет создание файла status.json, который содержит в себе информацию о статусе последней сборки коллекции проектов.
- Сгенерированный в виртуальной среде github actions во время выполнения сборки, статусный файл status.json будет незамедлительно загружен в репозиторий при помощи вспомогательного профиля с коммитом "chore: upload status"
- с помощью скрипта notify.py файл статуса status.json преобразуется в удобочитаемый формат и отправляется в телеграм чат при помощи телеграм-бота.

Доступ к статусному файлу может осуществляться через GET запрос, таким образом средствами github мы получаем json-API endpoint, обратившись к которому мы получим актуальный статус сборки коллекции проектов.

```
$ curl -X GET https://raw.githubusercontent.com/antonkurenkov/systembuilder_2021/develop/status.json
> {"2020-11-26 07:56:21": {"example-1": {"status": true, "message": null}}, "version": 0.9}
```
## Статус проекта
<br><img src="https://github.com/Voolodimer/systembuilder_2021/workflows/Commit-Action/badge.svg"><br>
